{
  "api_endpoints": {
    "wallet_registration": {
      "endpoint": "POST /api/wallet/register",
      "description": "Регистрация кошелька пользователя",
      "request_body": {
        "address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "chainId": 14800,
        "connectedAt": "2024-01-15T10:30:00.000Z",
        "lastActivity": "2024-01-15T10:30:00.000Z"
      },
      "response": {
        "success": true,
        "message": "Wallet registered successfully",
        "data": {
          "address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
          "chainId": 14800,
          "connectedAt": "2024-01-15T10:30:00.000Z",
          "lastActivity": "2024-01-15T10:30:00.000Z",
          "registeredAt": "2024-01-15T10:30:00.000Z"
        }
      }
    },
    "user_onboarding": {
      "endpoint": "POST /api/user/onboarding",
      "description": "Отправка данных опроса пользователя",
      "request_body": {
        "walletAddress": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "country": "United States",
        "birthMonth": "March",
        "birthYear": "1990",
        "isItRelated": "yes",
        "location": {
          "latitude": 40.7128,
          "longitude": -74.0060,
          "accuracy": 15.5,
          "timestamp": "2024-01-15T10:35:00.000Z"
        },
        "submittedAt": "2024-01-15T10:35:00.000Z"
      },
      "response": {
        "success": true,
        "message": "Onboarding data submitted successfully",
        "data": {
          "walletAddress": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
          "country": "United States",
          "birthMonth": "March",
          "birthYear": "1990",
          "isItRelated": "yes",
          "location": {
            "latitude": 40.7128,
            "longitude": -74.0060,
            "accuracy": 15.5,
            "timestamp": "2024-01-15T10:35:00.000Z"
          },
          "submittedAt": "2024-01-15T10:35:00.000Z"
        }
      }
    },
    "file_upload_to_refiner": {
      "endpoint": "POST /api/refine/upload",
      "description": "Загрузка аудио файла в refiner",
      "request_body": {
        "file": "FormData с .ogg файлом",
        "walletAddress": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "userData": {
          "walletAddress": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
          "country": "United States",
          "birthMonth": "March",
          "birthYear": "1990",
          "isItRelated": "yes",
          "location": {
            "latitude": 40.7128,
            "longitude": -74.0060,
            "accuracy": 15.5,
            "timestamp": "2024-01-15T10:35:00.000Z"
          }
        }
      },
      "response": {
        "success": true,
        "message": "File uploaded successfully to Storj and sent to refiner",
        "data": {
          "fileId": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6_1705314000000_voice_sample.ogg",
          "fileName": "voice_sample.ogg",
          "fileSize": 2048576,
          "uploadedAt": "2024-01-15T10:40:00.000Z",
          "storjUrl": "https://gateway.storjshare.io/bucket/audio/voice_sample.ogg",
          "metadata": {
            "audio_length": "128",
            "audio_source": "web_upload",
            "audio_type": "speech",
            "user": {
              "user_id": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
              "age": "34",
              "country_code": "US",
              "occupation": "Developer",
              "language_code": "en",
              "region": "North America"
            }
          }
        }
      }
    }
  },
  "refiner_integration": {
    "endpoint": "POST https://api.refiner.vana.com/refine",
    "description": "Отправка данных в VANA refiner",
    "request_body": {
      "refiner_id": "default-refiner",
      "audio_url": "https://gateway.storjshare.io/bucket/audio/voice_sample.ogg",
      "metadata": {
        "wallet_address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "file_name": "voice_sample.ogg",
        "file_size": 2048576,
        "uploaded_at": "2024-01-15T10:40:00.000Z",
        "user_data": {
          "country": "United States",
          "birth_month": "March",
          "birth_year": "1990",
          "is_it_related": "yes",
          "location": {
            "latitude": 40.7128,
            "longitude": -74.0060,
            "accuracy": 15.5,
            "timestamp": "2024-01-15T10:35:00.000Z"
          }
        }
      }
    },
    "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer your-encryption-key"
    }
  },
  "data_flow_summary": {
    "step_1_wallet_connection": {
      "action": "Пользователь подключает кошелек",
      "data_sent": {
        "wallet_address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "chain_id": 14800,
        "connection_timestamp": "2024-01-15T10:30:00.000Z"
      },
      "endpoint": "/api/wallet/register"
    },
    "step_2_onboarding_survey": {
      "action": "Пользователь заполняет опрос",
      "data_sent": {
        "wallet_address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "demographics": {
          "country": "United States",
          "birth_month": "March",
          "birth_year": "1990",
          "it_background": "yes",
          "location": {
            "latitude": 40.7128,
            "longitude": -74.0060,
            "accuracy": 15.5,
            "timestamp": "2024-01-15T10:35:00.000Z"
          }
        },
        "submission_timestamp": "2024-01-15T10:35:00.000Z"
      },
      "endpoint": "/api/user/onboarding"
    },
    "step_3_file_upload": {
      "action": "Пользователь загружает .ogg файлы",
      "data_sent": {
        "files": [
          {
            "name": "voice_sample.ogg",
            "size": 2048576,
            "type": "audio/ogg"
          }
        ],
        "wallet_address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
        "user_context": {
          "onboarding_data": "ссылка на данные из шага 2"
        }
      },
      "endpoint": "/api/refine/upload"
    },
    "step_4_refiner_processing": {
      "action": "Данные отправляются в VANA refiner",
      "data_sent": {
        "refiner_id": "default-refiner",
        "audio_url": "https://gateway.storjshare.io/bucket/audio/voice_sample.ogg",
        "metadata": {
          "wallet_address": "0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",
          "file_metadata": {
            "name": "voice_sample.ogg",
            "size": 2048576,
            "uploaded_at": "2024-01-15T10:40:00.000Z"
          },
          "user_metadata": {
            "demographics": "данные из onboarding",
            "processing_preferences": "настройки обработки"
          }
        }
      },
      "endpoint": "https://api.refiner.vana.com/refine"
    }
  },
  "environment_variables": {
    "required": {
      "BACKEND_API_URL": "https://your-backend-api.com",
      "BACKEND_API_KEY": "your-backend-api-key",
      "REFINEMENT_ENDPOINT": "https://api.refiner.vana.com",
      "REFINER_ID": "your-refiner-id",
      "REFINEMENT_ENCRYPTION_KEY": "your-encryption-key"
    },
    "optional": {
      "STORJ_ACCESS_KEY": "your-storj-access-key",
      "STORJ_SECRET_KEY": "your-storj-secret-key",
      "STORJ_BUCKET_NAME": "your-bucket-name"
    }
  },
  "data_types": {
    "wallet_data": {
      "type": "object",
      "required_fields": ["address", "chainId"],
      "optional_fields": ["connectedAt", "lastActivity"]
    },
    "onboarding_data": {
      "type": "object",
      "required_fields": ["walletAddress", "country", "birthMonth", "birthYear", "isItRelated"],
      "optional_fields": ["submittedAt", "location"],
      "location_fields": {
        "latitude": "number - широта",
        "longitude": "number - долгота", 
        "accuracy": "number - точность в метрах",
        "timestamp": "string - время получения координат"
      }
    },
    "file_upload_data": {
      "type": "FormData",
      "required_fields": ["file", "walletAddress"],
      "optional_fields": ["userData"]
    },
    "refiner_data": {
      "type": "object",
      "required_fields": ["refiner_id", "audio_url", "metadata"],
      "metadata_fields": ["wallet_address", "file_name", "file_size", "uploaded_at"]
    }
  }
} 